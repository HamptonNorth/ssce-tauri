<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SSCE - User Documentation</title>

        <!-- Favicon -->
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

        <!-- Tailwind CSS via CDN -->
        <script src="https://cdn.tailwindcss.com"></script>

        <!-- GitHub Markdown Style -->
        <link rel="stylesheet" href="/css/md-github.css" />

        <!-- Marked.js for Markdown Parsing -->
        <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>

        <style>
            /* Base container styles */
            #markdown-content {
                max-width: 1000px;
                margin: 0 auto;
                padding: 2rem;
            }

            /* Print styles - hide non-essential elements */
            @media print {
                #page-header,
                #btn-print {
                    display: none !important;
                }

                body {
                    background: white !important;
                }

                #markdown-content {
                    padding: 0 !important;
                }
            }

            /* A4 Page setup for print */
            @page {
                size: A4;
                margin: 2cm 2.5cm;
            }
        </style>
    </head>
    <body class="bg-gray-50">
        <!-- Page Header -->
        <div id="page-header" class="bg-white border-b border-gray-200 px-6 py-4 sticky top-0 z-10 shadow-sm">
            <div class="max-w-7xl mx-auto flex items-center justify-between">
                <h1 class="text-2xl font-bold text-gray-800">SSCE User Documentation</h1>
                <button
                    id="btn-print"
                    onclick="window.print()"
                    class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
                    title="Print this page"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"
                        />
                    </svg>
                    <span>Print to A4</span>
                </button>
            </div>
        </div>

        <!-- Markdown Content Container -->
        <div id="markdown-content" class="md-github bg-white shadow-lg">
            <div class="text-center py-8 text-gray-500">Loading documentation...</div>
        </div>

        <script>
            // Fetch and render the USER_DOCUMENTATION.md file
            async function loadDocumentation() {
                try {
                    const response = await fetch('/USER_DOCUMENTATION.md');
                    if (!response.ok) {
                        throw new Error('Failed to load documentation');
                    }

                    const markdown = await response.text();

                    // Configure marked options
                    marked.setOptions({
                        breaks: true,
                        gfm: true, // GitHub Flavored Markdown
                        headerIds: true,
                        mangle: false,
                    });

                    // Convert markdown to HTML
                    const html = marked.parse(markdown);

                    // Inject into page
                    const contentEl = document.getElementById('markdown-content');
                    contentEl.innerHTML = html;
                } catch (error) {
                    console.error('Error loading documentation:', error);
                    const contentEl = document.getElementById('markdown-content');
                    contentEl.innerHTML = `
                        <div class="text-center py-8">
                            <p class="text-red-600 font-semibold mb-2">Failed to load documentation</p>
                            <p class="text-gray-600">${error.message}</p>
                        </div>
                    `;
                }
            }

            // Load documentation on page load
            document.addEventListener('DOMContentLoaded', loadDocumentation);
        </script>
    </body>
</html>
